servo:
  connectors:
    - kubernetes
    - prometheus
    - vegeta

kubernetes:
  application:
    components:
      service:
        settings:
          cpu:
            type: range
            min: 0.1
            max: 1.8
            step: 0.1
            value: 1.0
          mem:
            type: range
            min: 0.1
            max: 10.0
            step: 0.1
            value: 5.0

prometheus:
  endpoint: http://prometheus.default.svc.cluster.local:9090
  metrics:
    gateway.throughput:
      query: sum(rate(http_requests_total{url!="",service!~"gateway.*"}[1m])) by (url) > 0
      unit: rate
    gateway.average_response_time:
      query: avg(rate(http_requests_duration_seconds_sum{service="gateway"}[1m]) / rate(http_requests_duration_seconds_count{service="gateway"}[1m]))
      unit: ms
    gateway.error_rate:
      query: sum(rate(http_requests_total{code=~"^^5.*"}[1m]))
      unit: rate

vegeta:
  rate: 50/s
  duration: 2m
  target: GET http://web.default.svc.cluster.local:8080/
  workers: 50
  max-workers: 100
  # sda: dsafd
